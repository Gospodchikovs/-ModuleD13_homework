<!--  наследуемся от шаблона default.html, который мы создавали ещё во времена flatpages -->
{% extends 'flatpages/default.html' %}
<!-- загружаем фильтры -->
{% block title %}
Объявления
{% endblock title %}

{% block content %}
    <h2>Все объявления (общее количество {{ advertisments|length }})</h2>
    {% if user.is_authenticated %}
        <a href="{% url 'advertisment_create' %}">Новое объявление </a>
        {% if is_subscriber %}
            <a href="{% url 'subscribe' %}">| Отписаться от рассылки </a>
        {% else %}
            <a href="{% url 'subscribe' %}">| Подписаться на рассылку </a>
        {% endif %}
    {% endif %}
    {% if advertisments %}
        <hr>
        <form method="GET">
            {{ filter.form}}
            <input type="submit" value="Найти">
            <a href="{% url 'advertisments' %}"> Сбросить фильтр </a>
        </form>
        <table>
            <tr>
                <th>
                    Автор
                </th>
                <th>
                    Категория
                </th>
                <th>
                    Заголовок
                </th>
                <th>
                    Дата публикации
                </th>
                <th>
                    Содержание
                </th>
                <th>
                </th>
            </tr>
        {% for advertisment in advertisments %}
            <tr>
                <td>
                    {{ advertisment.user }}
                </td>
                <td>
                    {{ advertisment.category }}
                </td>
                <td>
                     <a href="{% url 'advertisment' advertisment.id %}">{{ advertisment.heading  }}</a>
                </td>
                <td>
                    {{ advertisment.time_create|date:'d-m-y H:i' }}
                </td>
                <td>
                    {{ advertisment.body|truncatechars:50}}
                </td>
                <td>
                    {% if advertisment.user == user%}
                        <a href="{% url 'advertisment_update' advertisment.id %}"><u>Редактировать</u></a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </table>
    {% else %}
        <h2>Объявлений нет!</h2>
    {% endif %}
{% endblock content %}